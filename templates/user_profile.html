{% extends "base.html" %}

{% block title %}Meu Perfil - Lanches OP{% endblock %}

{% block content %}
<div style="display: flex; justify-content: center; padding-top: 20px;">
    <div class="glass-panel" style="width: 100%; max-width: 500px; padding: 40px;">

        <!-- Profile Header -->
        <div class="text-center mb-xl">
            <div
                style="width: 80px; height: 80px; background: var(--accent-cyan); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 20px rgba(0,255,255,0.4);">
                <i class="ph-bold ph-user" style="font-size: 40px; color: #000;"></i>
            </div>
            <h2 style="margin: 0; font-size: 1.8em;">Meu Perfil</h2>
            <div class="text-muted">Gerencie suas informações</div>
        </div>

        <form method="POST">
            <!-- Key Section (Highlighted & Centered) -->
            <div
                style="margin-bottom: 32px; padding: 24px; border-radius: 16px; position: relative; overflow: hidden; background: rgba(0,255,255,0.03); border: 1px solid rgba(0,255,255,0.1); text-align: center;">
                <div
                    style="position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--accent-cyan), transparent);">
                </div>

                <label for="petro_key"
                    style="color: var(--accent-cyan); font-weight: bold; display: block; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; font-size: 0.9em;">
                    Sua Chave de Acesso
                </label>

                <div style="position: relative; max-width: 200px; margin: 0 auto;">
                    <input type="text" id="petro_key" name="petro_key" value="{{ current_user.petro_key }}"
                        maxlength="4" required
                        style="text-transform: uppercase; font-size: 2em; letter-spacing: 4px; text-align: center; 
                               background: transparent; border: none; border-bottom: 2px solid var(--accent-cyan); 
                               color: white; padding: 10px; font-weight: bold; width: 100%; outline: none; margin-bottom: 0;"
                        onfocus="this.style.borderColor='var(--accent-purple)'"
                        onblur="this.style.borderColor='var(--accent-cyan)'">
                    <i class="ph-duotone ph-key"
                        style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); color: var(--accent-cyan); opacity: 0.5; font-size: 1.2em;"></i>
                </div>

                <p class="text-muted mt-sm" style="font-size: 0.85em;">Use esta chave para fazer login.</p>
            </div>

            <!-- Personal Info -->
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="name" style="margin-bottom: 8px; display: block;">Nome Completo</label>
                <div style="position: relative;">
                    <input type="text" id="name" name="name" value="{{ current_user.name }}" placeholder="Seu nome"
                        required style="padding-left: 45px; margin-bottom: 0;">
                    <i class="ph ph-identification-card"
                        style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 1.2em;"></i>
                </div>
            </div>

            <div class="form-group" style="margin-bottom: 30px;">
                <label for="phone" style="margin-bottom: 8px; display: block;">Telefone / WhatsApp</label>
                <div style="position: relative;">
                    <input type="tel" id="phone" name="phone" value="{{ current_user.phone or '' }}"
                        placeholder="(00) 00000-0000" style="padding-left: 45px; margin-bottom: 0;">
                    <i class="ph ph-whatsapp-logo"
                        style="position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 1.2em;"></i>
                </div>
            </div>

            <!-- Buttons Centered -->
            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" class="btn-neon"
                    style="height: 50px; font-size: 1.1em; padding: 0 40px; min-width: 200px;">
                    <i class="ph-bold ph-floppy-disk"></i> Salvar Alterações
                </button>
            </div>
        </form>

        <div class="mt-lg pt-md" style="border-top: 1px solid rgba(255,255,255,0.1); text-align: center;">
            <a href="{{ url_for('auth.logout') }}" class="btn-secondary"
                style="border-color: var(--danger); color: var(--danger); min-width: 150px;">
                <i class="ph-bold ph-sign-out"></i> Sair da Conta
            </a>
        </div>
    </div>
</div>

<script>
    document.getElementById('phone').addEventListener('input', function (e) {
        let x = e.target.value.replace(/\D/g, '').match(/(\d{0,2})(\d{0,5})(\d{0,4})/);
        e.target.value = !x[2] ? x[1] : '(' + x[1] + ') ' + x[2] + (x[3] ? '-' + x[3] : '');
    });
</script>
{% endblock %}