{% extends "base.html" %}

{% block title %}Editar Item - {{ item.name }}{% endblock %}

{% block content %}
<div class="glass-panel" style="padding: 30px; max-width: 800px; margin: 0 auto;">
    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 30px;">
        <a href="{{ url_for('admin.items') }}" class="icon-btn minimal" title="Voltar">
            <i class="ph ph-arrow-left" style="font-size: 24px;"></i>
        </a>
        <h2 style="margin: 0;">Editar Item</h2>
    </div>

    <form method="POST" enctype="multipart/form-data">
        <div style="display: grid; gap: 20px;">
            <!-- Name & Price -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
                <div>
                    <label>Nome do Item</label>
                    <input type="text" name="name" value="{{ item.name }}" class="input-field" required
                        style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px;">
                </div>
                <div>
                    <label>Preço (R$)</label>
                    <input type="number" step="0.01" name="price" value="{{ item.price }}" class="input-field" required
                        style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px;">
                </div>
            </div>

            <!-- Store -->
            <div>
                <label>Loja / Categoria</label>
                <select name="store_id" class="input-field"
                    style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px;">
                    <option value="">Sem Loja</option>
                    {% for store in stores %}
                    <option value="{{ store.id }}" {{ 'selected' if item.store_id==store.id else '' }}>{{ store.name }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Image -->
            <div>
                <label>Imagem URL (ou Upload)</label>
                <input type="text" name="image_url" value="{{ item.image_url }}" placeholder="http://..."
                    class="input-field"
                    style="width: 100%; padding: 10px; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px; margin-bottom: 10px;">
                <input type="file" name="image_file" class="input-field" style="color: white;">
            </div>

            <!-- Subitems Dynamic Editor -->
            {% include "partials/_subitems_editor.html" %}

            <!-- Actions -->
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button type="submit" class="btn-neon" style="flex: 1;" onclick="serializeSubitems()">
                    <i class="ph ph-floppy-disk"></i> Salvar Alterações
                </button>
                <a href="{{ url_for('admin.items') }}" class="btn-secondary"
                    style="text-decoration: none; text-align: center;">Cancelar</a>
            </div>
        </div>
    </form>
</div>
{% endblock %}